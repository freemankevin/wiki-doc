---
title: 磁盘管理
description: Linux - 磁盘管理
published: true
date: 2026-01-30T02:44:11.996Z
tags: linux, lvm, 磁盘管理, 磁盘
editor: markdown
dateCreated: 2026-01-30T01:34:55.690Z
---

# 磁盘管理

> Linux 相关的 磁盘管理 问题收集
{.is-info}


---

## 创建 LVM

### 1. 准备物理磁盘
首先查看系统中的磁盘：
```shell
# 查看所有磁盘
lsblk
# 或者
fdisk -l

# 输出示例：
# NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
# sda      8:0    0  100G  0 disk
# sdb      8:16   0   50G  0 disk
```

### 2. 创建物理卷（PV）
将磁盘分区转换为物理卷：
```shell
# 创建单个PV
sudo pvcreate /dev/sdb

# 创建多个PV
sudo pvcreate /dev/sdb /dev/sdc

# 查看已创建的PV
sudo pvdisplay
# 或者
sudo pvs
```

### 3. 创建卷组（VG）
将一个或多个物理卷组合成一个卷组：
```shell
# 创建卷组（使用单个PV）
sudo vgcreate my_vg /dev/sdb

# 创建卷组（使用多个PV）
sudo vgcreate my_vg /dev/sdb /dev/sdc

# 查看卷组信息
sudo vgdisplay
# 或者
sudo vgs

# 查看卷组内的详细信息
sudo vgdisplay my_vg
```

### 4. 创建逻辑卷（LV）
从卷组中分配逻辑卷：
```shell
# 创建逻辑卷（指定大小）
sudo lvcreate -L 20G -n my_lv my_vg

# 创建逻辑卷（使用全部可用空间）
sudo lvcreate -l 100%FREE -n my_lv my_vg

# 查看逻辑卷信息
sudo lvdisplay
# 或者
sudo lvs
```

### 5. 创建文件系统
在逻辑卷上创建文件系统：
```shell
# 创建ext4文件系统
sudo mkfs.ext4 /dev/my_vg/my_lv

# 创建xfs文件系统
sudo mkfs.xfs /dev/my_vg/my_lv
```

### 6. 挂载逻辑卷
将逻辑卷挂载到系统中：
```shell
# 创建挂载点
sudo mkdir -p /mnt/my_data

# 临时挂载
sudo mount /dev/my_vg/my_lv /mnt/my_data

# 永久挂载（编辑/etc/fstab）
sudo vi /etc/fstab
# 添加下面一行
# /dev/my_vg/my_lv  /mnt/my_data  ext4  defaults  0  0

# 验证挂载
mount | grep my_lv
# 或者
df -h
```

### 7. 验证LVM创建
```shell
# 查看完整的LVM架构
sudo pvs
sudo vgs
sudo lvs

# 详细信息
sudo pvdisplay
sudo vgdisplay
sudo lvdisplay
```

---

## LVM 磁盘扩容

### 1.添加新的物理磁盘
```shell
# 插入新磁盘，查看识别情况
lsblk

# 创建新的物理卷
sudo pvcreate /dev/sdd
```

### 2.扩展卷组
```shell
# 将新物理卷添加到现有卷组
sudo vgextend my_vg /dev/sdd

# 验证卷组扩展
sudo vgdisplay my_vg
```

### 3.扩展逻辑卷
```shell
# 方式1：扩展指定大小
sudo lvextend -L +10G /dev/my_vg/my_lv

# 方式2：扩展到卷组的全部可用空间
sudo lvextend -l +100%FREE /dev/my_vg/my_lv

# 验证逻辑卷扩展
sudo lvdisplay /dev/my_vg/my_lv
```

### 4.扩展文件系统
> 此步骤至关重要，不进行此步文件系统仍然是原来的大小！
{.is-warning}

```shell
# 对于ext4文件系统（推荐先卸载）
sudo umount /mnt/my_data
sudo e2fsck -f /dev/my_vg/my_lv
sudo resize2fs /dev/my_vg/my_lv

# 或者如果文件系统支持在线扩展，可以不卸载
sudo resize2fs /dev/my_vg/my_lv

# 对于xfs文件系统（支持在线扩展，不需卸载）
sudo xfs_growfs /mnt/my_data

# 验证文件系统扩展
df -h /mnt/my_data
```

---

[返回 Linux](/linux)
