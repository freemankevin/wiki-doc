---
title: 内核优化
description: Linux - 内核优化
published: true
date: 2026-01-30T02:50:03.649Z
tags: kernel, linux, 优化
editor: markdown
dateCreated: 2026-01-30T01:35:02.048Z
---

# 内核优化

> Linux 相关的 内核优化 问题收集
{.is-info}


---
备份原有配置：

```bash
cp /etc/sysctl.conf{,.bak}
echo -e '' > /etc/sysctl.conf
```

写入优化后的配置：

```bash
tee -a /etc/sysctl.conf << EOF
fs.file-max = 1048576
fs.aio-max-nr = 1048576
vm.max_map_count = 262144
kernel.shmall = 4294967296
kernel.shmmax = 4294967295
kernel.shmmni = 4096
kernel.sysrq = 0
kernel.dmesg_restrict = 1
kernel.sem = 250 32000 100 128
net.ipv4.ip_forward = 1
net.ipv4.conf.all.send_redirects = 0
net.ipv4.conf.default.send_redirects = 0
net.ipv4.conf.all.accept_source_route = 0
net.ipv4.conf.default.accept_source_route = 0
net.ipv4.conf.all.accept_redirects = 0
net.ipv4.conf.default.accept_redirects = 0
net.ipv4.conf.all.secure_redirects = 0
net.ipv4.conf.default.secure_redirects = 0
net.ipv4.icmp_echo_ignore_broadcasts = 1
net.ipv4.icmp_ignore_bogus_error_responses = 1
net.ipv4.conf.all.rp_filter = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.tcp_syncookies = 1
net.ipv4.ip_local_port_range = 1024 65535
net.core.rmem_default = 16777216
net.core.rmem_max = 16777216
net.core.wmem_default = 16777216
net.core.wmem_max = 16777216
net.ipv4.tcp_fin_timeout = 30
net.ipv4.tcp_tw_reuse = 1
EOF
```

刷新配置：

```bash
sysctl -p
```

启用中断负载均衡：

```bash
systemctl enable irqbalance --now
systemctl start irqbalance
```

设置文件描述符限制：

```bash
grep -qxF '* soft nofile 1048576' /etc/security/limits.conf || echo '* soft nofile 1048576' >> /etc/security/limits.conf
grep -qxF '* hard nofile 1048576' /etc/security/limits.conf || echo '* hard nofile 1048576' >> /etc/security/limits.conf
```



---

[返回 Linux](/linux)
